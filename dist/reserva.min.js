"use strict";function rand(e,t){return Math.random()*(t-e)+e}function setLayoutProperties(){var e=316;ui.window={},ui.window.width=$window.width(),ui.window.height=$window.height(),ui.columns=Math.floor(ui.window.width/e);var t=void 0;t=1===ui.columns?"single-column":2===ui.columns?"dual-column":"multi-column",$body.removeClass("single-column dual-column multi-column").addClass(t)}function setScrollPosition(){ui["scroll-position"].top=$window.scrollTop(),ui["scroll-position"].bottom=ui["scroll-position"].top+ui.window.height}function __render(e,t){if(!$templates[e])return!1;var a=$templates[e].clone();return a.data(t),$.fn.fillBlanks=function(){var e=$(this),a=e.data("fill"),o=e.data("fill-object"),i=e.data("fill-field"),n=e.data("fill-attr"),s=void 0;if(a)for(var r=a.split(","),l=0;l<r.length;l++){var d=r[l].split(":"),m=d[1]?d[0].trim():"html",u=d[1]?d[1].trim():d[0],c=void 0;if(u=u.split("/"),c=u.length>1?t[u[0]][u[1]]:t[u])"class"===m?e.addClass(c):"html"===m?e.html(c):"value"===m?e.val(c):e.attr(m,c);else{var p=e.data("fill-null");"hide"===p?e.hide():"remove"===p&&e.remove()}}else if(o?o&&t[o]&&(s=t[o][i]):s=t[i],s)"class"===n?e.addClass(s):n?e.attr(n,s):e.html(s);else{var p=e.data("fill-null");"hide"===p?e.hide():"remove"===p&&e.remove()}e.removeClass("fill").removeAttr("data-fill").removeAttr("data-fill-object").removeAttr("data-fill-field").removeAttr("data-fill-attr").removeAttr("data-fill-null")},a.hasClass("fill")&&a.fillBlanks(),$(".fill",a).each(function(){$(this).fillBlanks()}),a}function upload(e){FileAPI.filterFiles(e,function(e,t){return/^image/.test(e.type)?(file_stack[e.name]=t,!0):!1},function(e,t){e.length&&($(".submit",$post).addClass("disabled"),FileAPI.each(e,function(e){var t=file_stack[e.name].exif.Orientation;if(file_stack[e.name].ref=tarefa_active+"-"+user.id+"-"+moment().format("X")+"-"+rand(0,999).toFixed(0),"image/gif"==e.type){var a=new FileReader;a.onload=function(t){var a=$("<img />").attr("src",t.target.result),o=$('<input type="hidden" name="image-order[]" />').val(file_stack[e.name].ref),i=$("<div />").addClass("progress");$("<div />").addClass("status").html("<strong>Enviando&hellip;</strong>").appendTo(i),$("<div />").addClass("bar").appendTo(i);var n=$("<li />").attr("id","file-"+file_stack[e.name].ref).append(o).append(i).append(a);$("#dropzone #board").append(n)},a.readAsDataURL(e)}else FileAPI.Image(e).rotate(exif_orientation_to_degrees[t]).resize(600,300,"preview").get(function(t,a){var o=$('<input type="hidden" name="image-order[]" />').val(file_stack[e.name].ref),i=$("<div />").addClass("progress");$("<div />").addClass("status").html("<strong>Enviando&hellip;</strong>").appendTo(i),$("<div />").addClass("bar").appendTo(i);var n=$("<li />").attr("id","file-"+file_stack[e.name].ref).append(o).append(i).append(a);$("#dropzone #board").append(n)})}),"image/gif"==e[0].type?(console.log("gif"),FileAPI.upload({url:"/-/lista/novo",data:{action:"upload",edition:"xci",tarefa:tarefa_active,turma:user.turma,user:user.id},prepare:function(e,t){t.data.ref=file_stack[e.name].ref,e.ref=file_stack[e.name].ref},files:e,fileprogress:function(e,t,a){var o=(e.loaded/e.total*100).toFixed(0),i=100>o?"<strong>Enviando&hellip;</strong> "+o+"%":"<strong>Processando&hellip;</strong>";$("#file-"+t.ref+" .status","#dropzone").html(i)},progress:function(e){},filecomplete:function(e,t,a){$("#file-"+a.ref+" .status","#dropzone").html('<i class="material-icons">check</i>')},complete:function(e,t){$(".submit",$post).removeClass("disabled")}})):FileAPI.upload({url:"/-/lista/novo",data:{action:"upload",edition:"xci",tarefa:tarefa_active,turma:user.turma,user:user.id},prepare:function(e,t){t.data.ref=file_stack[e.name].ref,e.ref=file_stack[e.name].ref},imageAutoOrientation:!0,imageTransform:{maxWidth:1920,maxHeight:1920},files:e,fileprogress:function(e,t,a){var o=(e.loaded/e.total*100).toFixed(0),i=100>o?"<strong>Enviando&hellip;</strong> "+o+"%":"<strong>Processando&hellip;</strong>";$("#file-"+t.ref+" .status","#dropzone").html(i)},progress:function(e){},filecomplete:function(e,t,a){$("#file-"+a.ref+" .status","#dropzone").html('<i class="material-icons">check</i>')},complete:function(e,t){$(".submit",$post).removeClass("disabled")}}))})}function checkUpdates(){var e=0;$.getJSON("https://api.laguinho.org/lista/"+edicao+"/atividade?key="+api_key+"&callback=?").done(function(t){if($.each(t,function(t,a){moment(a.ts).isAfter(last_updated)&&a.autor!=user.id&&(e++,"novo-post"==a.acao?updated.posts++:"nova-tarefa"==a.acao&&updated.tarefas++)}),e){var a=void 0,o=updated.tarefas+updated.posts;updated.tarefas>0&&updated.posts>0?a=updated.tarefas+(updated.tarefas>1?" novas tarefas":" nova tarefa")+" e "+updated.posts+(updated.posts>1?" novos posts":" novo post"):updated.tarefas>0?a=updated.tarefas+(updated.tarefas>1?" novas tarefas":" nova tarefa"):updated.posts>0&&(a=updated.posts+(updated.posts>1?" novos posts":" novo post")),$("head title").html("("+o+") "+page_title),UI.toast.open(a,"Atualizar",function(){Stream.load(),updated={tarefas:0,posts:0},$("head title").html(page_title)},!0,"stream-only")}last_updated=t[0]?moment(t[0].ts):moment()})}var edicao="xci",Lista=[];Lista.Regulamento=[],Lista.Tarefas=[];var app=[],UI=[],$ui=[],tarefas={};$(function(){});var $window=void 0,$body=void 0,timeout=[],$theme_color=void 0,theme_color={},tarefa_active=void 0;$(function(){$window=$(window),$body=$(document.body),$theme_color=$("meta[name='theme-color']"),theme_color.original=$theme_color.attr("content")}),$.fn.reflow=function(){$body.offset().left;return $(this)};var ui={};ui["interaction-type"]="ontouchstart"in window||navigator.msMaxTouchPoints?"touch":"pointer",$(document).on("ready",setLayoutProperties),$(window).on("resize",setLayoutProperties),ui["scroll-position"]={},$(document).on("ready",setScrollPosition),$(window).on("scroll",setScrollPosition);var api_key=void 0;api_key="063c72b2afc5333f3b27b366bdac9eb81d64bc6a12cd7b3f4b6ade77a092b63a";var $templates={};$(function(){$("template").each(function(){var e=$(this),t=e.attr("id"),a=e.html();$templates[t]=$(a),e.remove()})}),app.Placar=function(e){var t=e.reduce(function(e,t){return e+t.pontos},0);$placar.empty(),$.each(e,function(e,a){var o=t>0?a.pontos/t:0;a["altura-da-barra"]="height: "+(100*o).toFixed(3)+"%",a["turma-formatada"]=a.turma.toUpperCase(),a.pontos=a.pontos,a["pontuacao-formatada"]=a.pontos.toString().replace(/\B(?=(\d{3})+(?!\d))/g,".");var i=__render("scoreboard-team",a);$placar.append(i)}),0===t?$placar.parent().addClass("zeroed"):$placar.parent().removeClass("zeroed")};var $placar=void 0;$(function(){$placar=$(".scoreboard ul")}),WebFont.load({timeout:1e4,google:{families:["Material Icons","Roboto:400,400italic,500:latin","Montserrat::latin"]},custom:{families:["FontAwesome"],urls:["https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.3.0/css/font-awesome.min.css"]},active:function(){$(function(){stream.layout()})}}),moment.locale("pt-br",{months:"janeiro_fevereiro_março_abril_maio_junho_julho_agosto_setembro_outubro_novembro_dezembro".split("_"),monthsShort:"jan_fev_mar_abr_mai_jun_jul_ago_set_out_nov_dez".split("_"),weekdays:"domingo_segunda-feira_terça-feira_quarta-feira_quinta-feira_sexta-feira_sábado".split("_"),weekdaysShort:"dom_seg_ter_qua_qui_sex_sáb".split("_"),weekdaysMin:"dom_2ª_3ª_4ª_5ª_6ª_sáb".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D [de] MMMM [de] YYYY",LLL:"D [de] MMMM [de] YYYY [às] HH:mm",LLLL:"dddd, D [de] MMMM [de] YYYY [às] HH:mm"},calendar:{sameDay:"[hoje às] LT",nextDay:"[amanhã às] LT",nextWeek:"dddd [às] LT",lastDay:"[ontem às] LT",lastWeek:"dddd [às] LT",sameElse:"L"},relativeTime:{future:"daqui %s",past:"%s atrás",s:"poucos segundos",m:"um minuto",mm:"%d minutos",h:"uma hora",hh:"%d horas",d:"um dia",dd:"%d dias",M:"um mês",MM:"%d meses",y:"um ano",yy:"%d anos"},ordinalParse:/\d{1,2}º/,ordinal:"%dº"});var current_view=["home"],view_manager=function(){return{add:function(e){current_view.push(e)},remove:function(e){current_view=$.grep(current_view,function(t){return t!=e})},replace:function(e){current_view=[],view_manager.add(e)}}}();window.addEventListener("popstate",function(e){var t=e.state;t&&"tarefa"==t.view?(current_view.indexOf("bottomsheet")>-1&&bottomsheet.close(),current_view.indexOf("new-post")>-1&&post.close(),tarefa.open(t.id)):t&&"new-post"==t.view?post.open(t.type,t.id):t&&"bottomsheet"==t.view?current_view.indexOf("new-post")>-1&&post.close():(current_view.indexOf("bottomsheet")>-1&&bottomsheet.close(),current_view.indexOf("new-post")>-1&&post.close(),tarefa.close())});var sidenav=function(){return{open:function(){backdrop.show(),$sidenav.addClass("in"),$body.addClass("no-scroll"),$backdrop.on("hide",sidenav.close)},close:function(){$body.removeClass("no-scroll"),$sidenav.removeClass("in"),backdrop.hide()}}}(),$sidenav=void 0;$(function(){$sidenav=$("#sidenav"),$(".sidenav-trigger").on("click",function(e){e.preventDefault(),sidenav.open()})});var bottomsheet=function(){return{open:function(e,t){backdrop.show(),$bottomsheet.html(e).addClass((t?t+" ":"")+"in").reflow().addClass("slide"),theme_color.buffer=$theme_color.attr("content"),$theme_color.attr("content","#000"),$backdrop.on("hide",bottomsheet.close),view_manager.add("bottomsheet"),history.pushState({view:"bottomsheet"},null,null)},close:function(){$bottomsheet.removeClass("slide").one("transitionend",function(){$bottomsheet.removeClass("in").empty().removeClass()}),$theme_color.attr("content",theme_color.buffer),backdrop.hide(),view_manager.remove("bottomsheet")}}}(),$bottomsheet=void 0;$(function(){$bottomsheet=$("#bottom-sheet")}),UI.toast=function(){return{open:function(e,t,a,o){$toast.message.html(e),$toast.action.html(t?t:""),$toast.addClass("in").reflow().addClass("slide"),$body.addClass("toast-active"),$toast.on("click",toast.close),$toast.action.on("click",a),clearTimeout(timeout.toast),o?$toast.addClass("stream-only"):($toast.removeClass("stream-only"),timeout.toast=setTimeout(toast.close,6500))},close:function(){$body.removeClass("toast-active"),$toast.removeClass("slide").one("transitionend",function(){$toast.removeClass("in").removeClass(),$toast.message.empty()}),clearTimeout(timeout.toast)}}}();var toast=UI.toast,$toast=void 0;$(function(){$toast=$("#toast"),$toast.message=$(".message",$toast),$toast.action=$(".action",$toast)});var backdrop=function(){return{show:function(){$backdrop.addClass("in")},hide:function(){$backdrop.removeClass("in").off("hide")}}}(),$backdrop=void 0;$(function(){$backdrop=$("#backdrop"),$backdrop.on("click",function(){$backdrop.trigger("hide")})});var Stream=function(){return{load:function(){$stream.loading.addClass("fade-in in"),$.getJSON("https://api.laguinho.org/lista/"+edicao+"/tudo?key="+api_key+"&callback=?").done(function(e){Lista.Regulamento=e.meta,Lista.Tarefas=e.tarefas,e.meta.titulo&&(page_title=e.meta.titulo,$("head title").html(page_title)),e.meta.mensagem&&$(".js-message").html(e.meta.mensagem),moment().isAfter(Lista.Regulamento.fim)&&$body.addClass("postagens-encerradas"),Lista.Regulamento.encerrada===!0&&($body.addClass("edicao-encerrada"),clearInterval(update_interval)),$stream.empty(),app.Placar(e.placar),$.each(e.tarefas,function(e,t){tarefas[t.numero]=t,t.url="/tarefas/"+t.numero,t.imagem&&(t["imagem-url"]=t.imagem.url,t["imagem-aspecto"]="padding-top: "+(100*t.imagem.aspecto).toFixed(2)+"%");var a=__render("card-tarefa",t).data({tarefa:t.numero,"last-modified":t["ultima-postagem"]?moment(t["ultima-postagem"]).format("X"):0});t.preview&&(a.addClass("fantasma"),$("a",a).removeAttr("href"),$(".body",a).remove(),$(".header .titulo",a).css("padding-bottom",rand(10,40))),t.imagem||$(".media",a).remove();var o=$(".grid",a);if(t.posts&&t.posts.length)for(var i=t.posts.length,n=ui.columns<2?9:8,s=0,r=["imagem","youtube","vimeo","vine","gif"],l=["texto"],d=0;i>d;d++){var m=t.posts[d];if((m.midia||"texto"==m.tipo)&&n>s){s++;var u=void 0,c={};r.indexOf(m.tipo)>-1?(u="tile-image",c.count=s,"youtube"==m.tipo||"vimeo"==m.tipo||"vine"==m.tipo||"gif"==m.tipo?(c.preview="background-image: url('"+m.midia[0].thumbnail+"');",c.modifier="video"):m.midia&&m.midia[0]&&(c.preview="background-image: url('"+m.midia[0].caminho+m.midia[0].arquivos[0]+"');")):l.indexOf(m.tipo)>-1&&(u="tile-text",c={preview:m.legenda.substring(0,120),count:s}),s===n&&i-s>0&&(c.modifier="more",c.more="+&thinsp;"+(i-s+1));__render(u,c).appendTo(o)}}else o.remove();$stream.append(a).isotope("appended",a)}),Stream.layout(),Stream.sort(Lista.Regulamento.encerrada?"tarefa":"date"),autoload&&(tarefa.open(autoload),autoload=null),setTimeout(function(){$stream.loading.removeClass("fade-in").one("transitionend",function(){$stream.loading.removeClass("in")})},1200),last_updated=moment(e.meta["ultima-atualizacao"]),updated.tarefas=0,updated.posts=0})},layout:function(){$stream.isotope("reloadItems"),$stream.isotope("layout")},sort:function(e){$stream.isotope({sortBy:e})}}}(),stream=Stream,$stream=void 0;$(function(){$stream=$("#stream"),$stream.loading=$("main .loading"),$stream.isotope({itemSelector:".card",transitionDuration:".8s",getSortData:{date:".last-modified",tarefa:function(e){return parseInt($(e).data("tarefa"),10)}},sortAscending:{date:!1,tarefa:!0},sortBy:["date","tarefa"],masonry:{gutter:1===ui.columns?8:16}}),$stream.on("click",".card.tarefa:not(.fantasma)",function(e){if(1===e.which){e.preventDefault();var t=$(this).data("tarefa");tarefa.open(t,!0)}}),stream.load(),$sidenav.on("click",".js-stream-sort a",function(e){e.preventDefault();var t=$(this).data("sort-by");$(".js-stream-sort a",$sidenav).removeClass("active"),$(this).addClass("active"),Stream.sort(t),sidenav.close()})});var tarefa=function(){function e(e,a){t.total=0;for(var o in Lista.Regulamento.turmas)t[Lista.Regulamento.turmas[o]]=0;$.each(e,function(e,o){o["data-de-postagem-formatada"]=moment(o["data-de-postagem"]).calendar(),o["turma-formatada"]=o.turma.toUpperCase(),o.avaliacao?(200==o.avaliacao.status?(o["status-class"]=o.turma,o["status-icon"]='<i class="material-icons">&#xE87D;</i>',o.status=o.avaliacao.pontos+" ponto"+(o.avaliacao.pontos>1?"s":"")):(o["status-class"]="rejected",o["status-icon"]='<i class="material-icons">&#xE888;</i>',o.status="Reprovado"),o.mensagem=o.avaliacao.mensagem,t.total+=o.avaliacao.pontos,t[o.turma]+=o.avaliacao.pontos):(o["status-icon"]='<i class="material-icons">&#xE8B5;</i>',o.status="Aguardando avaliação"),o.legenda&&"<p>"!=o.legenda.substring(0,3)&&(o.legenda="<p>"+o.legenda.replace(/(?:\r\n\r\n|\r\r|\n\n)/g,"</p><p>")+"</p>");var i=__render("view-tarefa-post-card",o),n=$(".media",i);o.midia&&$.each(o.midia,function(e,t){if("imagem"==o.tipo){t["default"]=t.caminho+t.arquivos[1],t["padding-aspecto"]="padding-top: "+(100*t.aspecto).toFixed(2)+"%",t["link-original"]=t.caminho+t.arquivos[2];var a=__render("media-photo",t);n.append(a)}else if("youtube"==o.tipo||"vimeo"==o.tipo||"vine"==o.tipo){"youtube"==o.tipo?t.embed="https://www.youtube.com/embed/"+t["youtube-id"]+"?rel=0&amp;showinfo=0":"vimeo"==o.tipo?t.embed="https://player.vimeo.com/video/"+t["vimeo-id"]+"?title=0&byline=0&portrait=0":"vine"==o.tipo&&(t.embed="https://vine.co/v/"+t["vine-id"]+"/embed/simple"),t["padding-aspecto"]="padding-top: "+(100*t.aspecto).toFixed(2)+"%";var i=__render("media-video",t);n.append(i)}}),o.legenda||$(".caption",i).remove(),o.avaliacao&&o.mensagem||$(".result .message",i).remove(),a.append(i).isotope("appended",i)})}var t=[];return{open:function(e,t){var a=tarefas[e];tarefa_active=e,$tarefa.addClass("in"),tarefa.render(a),$tarefa.reflow().addClass("slide").one("transitionend",function(){$("head meta[name='theme-color']").attr("content","#546e7a")}),$body.addClass("no-scroll tarefa-active"),view_manager.replace("tarefa"),t&&history.pushState({view:"tarefa",id:a.numero},a.titulo,"/tarefas/"+a.numero)},render:function(a){var o=__render("view-tarefa",a),i=$(".painel .meta",o);a.imagem&&(tarefa["imagem-url"]=a.imagem.url,tarefa["imagem-aspecto"]="padding-top: "+(100*a.imagem.aspecto).toFixed(2)+"%");var n=__render("card-tarefa",a);a.imagem||$(".media",n).remove(),$(".grid",n).remove(),i.append(n);var s=o.find(".posts ul");a.posts.length?(s.isotope({itemSelector:".card",transitionDuration:0,masonry:{gutter:1===ui.columns?8:16}}),e(a.posts,s)):$("<li />").addClass("empty").text("Nenhum post").appendTo(s),$tarefa.html(o),a.posts.length&&s.isotope("layout");var r=$(".painel .placar ul",o);$.each(Lista.Regulamento.turmas,function(e,a){var o=[],i=t.total>0?t[a]/t.total:0;o.turma=a,o["altura-da-barra"]="height: "+(100*i).toFixed(3)+"%",o["turma-formatada"]=a.toUpperCase(),o.pontos=t[a]>0?t[a]:0,o["pontuacao-formatada"]=o.pontos.toString().replace(/\B(?=(\d{3})+(?!\d))/g,".");var n=__render("scoreboard-team",o);r.append(n)})},close:function(e){tarefa_active=null,$("head meta[name='theme-color']").attr("content",theme_color.original),$body.removeClass("no-scroll tarefa-active"),$tarefa.removeClass("slide").one("transitionend",function(){$tarefa.removeClass("in").empty()}),view_manager.replace("home"),e&&history.pushState({view:"home"},"Lista de Tarefas","/tarefas")}}}(),Tarefa=tarefa,$tarefa=void 0;$(function(){$tarefa=$("#tarefa"),$tarefa.on("click",".back",function(e){e.preventDefault(),tarefa.close(!0)}).on("click",".js-new-post-trigger",function(){bottomsheet.open($(".new-post-sheet",$tarefa).clone().show())}).on("click",".card.tarefa a",function(e){1===e.which&&e.preventDefault()})});var NewPost=function(){return{authorize:function(){$(".submit",$post).removeClass("disabled")},deauthorize:function(){$(".submit",$post).addClass("disabled")},getThumbnail:function(e){function t(e){var t=$("<img />").attr("src",e.thumbnail);$(".js-media-provider",$post).val(e.provider),$(".js-media-id",$post).val(e.id),$(".js-media-thumbnail",$post).val(e.thumbnail),$(".js-media-preview",$post).html(t).fadeIn()}var a={};if(e.match(/(?:https?:\/{2})?(?:w{3}\.)?youtu(?:be)?\.(?:com|be)(?:\/watch\?v=|\/)([^\s&]+)/)){var o=e.match(/(?:https?:\/{2})?(?:w{3}\.)?youtu(?:be)?\.(?:com|be)(?:\/watch\?v=|\/)([^\s&]+)/);a.provider="youtube",a.id=o[1],a.thumbnail="https://i1.ytimg.com/vi/"+o[1]+"/0.jpg",NewPost.authorize(),t(a)}else if(e.match(/vimeo\.com/)){var i=e.match(/\/\/(www\.)?vimeo.com\/(\d+)($|\/)/);a.provider="vimeo",a.id=i[2],$.getJSON("https://vimeo.com/api/v2/video/"+i[2]+".json?callback=?").done(function(e){a.thumbnail=e[0].thumbnail_large,NewPost.authorize(),t(a)})}else if(e.match(/vine\.co/)){var n=e.match(/\/\/(www\.)?vine\.co\/v\/([^\s&]+)($|\/)/);a.provider="vine",a.id=n[2],$.getJSON("//assets.laguinho.org/helpers/vine-thumbnail?id="+n[2]+"&callback=?").done(function(e){a.thumbnail=e.thumbnail,NewPost.authorize(),t(a)})}},open:function(e,t){var a={numero:t||tarefa_active,user:user.id,turma:user.turma,token:user.token},o=__render("new-post-"+e,a);$post.html(o).addClass("in").reflow().addClass("slide").one("transitionend",function(){var e=$(".appbar",$post).css("background-color");$("head meta[name='theme-color']").attr("content",e)}),NewPost.deauthorize(),"photo"===e?($post.dropzone(),$(".file-placeholder",$post).trigger("click")):"video"===e||"vine"===e?$(".js-media-url-input",$post).focus().on("keyup",function(){NewPost.getThumbnail($(this).val())}):"text"===e&&$(".js-text-input",$post).focus().on("keyup",function(){$(this).val().length>0?NewPost.authorize():NewPost.deauthorize()}),view_manager.replace("new-post"),history.replaceState({view:"new-post",type:e,id:a.numero},null,null)},close:function(){$("head meta[name='theme-color']").attr("content",theme_color.original),$post.removeClass("slide").one("transitionend",function(){$post.removeClass("in").empty()}),view_manager.replace("tarefa")}}}(),post=NewPost,$post=void 0;$(function(){$post=$("#new-post"),$bottomsheet.on("click",".new-post-sheet a",function(e){e.preventDefault();var t=$(this).data("post-type");bottomsheet.close(),setTimeout(function(){NewPost.open(t,tarefa_active)},600)}),$post.on("submit","form",function(e){e.preventDefault()}).on("click",".submit",function(e){if(e.preventDefault(),moment().isAfter(Lista.Regulamento.fim)&&toast.open("Postagens encerradas!"),$(this).hasClass("disabled"))return void toast.open("Espere o fim do upload&hellip;");var t=$("form",$post).serialize();$(".submit",$post).addClass("disabled").html("Enviando&hellip;"),$.post("/-/lista/novo",t).done(function(e){200===e.response.status?(NewPost.close(),tarefa.render(e.data),toast.open(e.response.message),navigator.vibrate(800),tarefas[e.data.numero]=e.data):toast.open(e.response.message?e.response.message:"Ocorreu um erro. Tente novamente")}).fail(function(){toast.open("Ocorreu um erro. Tente novamente")})}).on("click",".back",function(e){e.preventDefault(),NewPost.close()})});var $login=void 0,login=function(){return{show:function(){$login.addClass("in").reflow().addClass("slide"),$body.addClass("no-scroll"),setTimeout(function(){$("input[name='email']",$login).focus()},300)},hide:function(){$body.removeClass("no-scroll"),$login.removeClass("slide").one("transitionend",function(){$login.removeClass("in")})}}}();$(function(){$login=$("#login"),$(".js-login-trigger",$sidenav).on("click",function(e){e.preventDefault(),sidenav.close(),login.show()}),$login.on("click",".back",function(e){e.preventDefault(),login.hide()}).on("submit","form",function(e){e.preventDefault(),$.getJSON("https://api.laguinho.org/lista/"+edicao+"/auth?key="+api_key+"&callback=?",$("form",$login).serialize()).done(function(e){200===e.meta.status?(user=e.user,user["signed-in"]=!0,localStorage.setItem("user",JSON.stringify(user)),$body.addClass("signed-in user-"+user.turma),login.hide(),setTimeout(function(){toast.open("Olá "+user.name+"!")},500)):($(".form-group",$login).addClass("animated shake"),setTimeout(function(){$(".form-group",$login).removeClass("animated shake")},1e3))})}),$(".js-logout-trigger",$sidenav).on("click",function(e){e.preventDefault(),$body.removeClass("signed-in user-"+user.turma),user={id:null,name:null,email:null,token:null,turma:null,"signed-in":!1},localStorage.setItem("user",JSON.stringify(user)),sidenav.close(),setTimeout(function(){toast.open("Sessão encerrada!")},500)})});var user={id:null,name:null,email:null,token:null,turma:null,"signed-in":!1};localStorage&&localStorage.getItem("user")&&(user=JSON.parse(localStorage.getItem("user")),$(function(){null!==user.id&&($body.addClass("signed-in user-"+user.turma),setTimeout(function(){toast.open("Olá "+user.name+"!")},4e3))}));var exif_orientation_to_degrees={0:0,1:0,2:0,3:180,4:0,5:0,6:90,7:0,8:270},file_stack={};$.fn.dropzone=function(){var e=$("#dropzone",this);FileAPI.event.dnd(e[0],function(t){t?e.addClass("active"):e.removeClass("active")},function(e){upload(e)});var t=document.getElementById("form-file");FileAPI.event.on(t,"change",function(e){var t=FileAPI.getFiles(e);upload(t)});var a=$("#board",this);a.on("slip:beforewait",function(e){"pointer"===ui["interaction-type"]&&e.preventDefault()}).on("slip:afterswipe",function(e){e.target.remove()}).on("slip:reorder",function(e){return e=e.originalEvent,e.target.parentNode.insertBefore(e.target,e.detail.insertBefore),!1}),new Slip(a[0])};var update_interval=setInterval(checkUpdates,3e4),page_title=$("head title").html(),last_updated=void 0,updated={tarefas:0,posts:0};