function rand(e,t){return Math.random()*(t-e)+e}function __render(e,t){if(!$templates[e])return!1;var a=$templates[e].clone();return a.data(t),$.fn.fillBlanks=function(){for(var e=$(this),a=e.data("fill"),o=a.split(","),i=0;i<o.length;i++){var n=o[i].split(":"),s=n[1]?n[0].trim():"html",r=n[1]?n[1].trim():n[0],l=t[r];if(r=r.split("/"),r.length>1){l=t[r[0]];for(var d=1;d<r.length;d++)l=l[r[d]]}if("undefined"!=typeof l&&null!==l)"class"===s?e.addClass(l):"html"===s?e.html(l):"value"===s?e.val(l):e.attr(s,l);else{var u=e.data("fill-null");"hide"===u?e.hide():"remove"===u&&e.remove()}}e.removeClass("fill").removeAttr("data-fill").removeAttr("data-fill-null")},a.hasClass("fill")&&a.fillBlanks(),$(".fill",a).each(function(){$(this).fillBlanks()}),a}function setLayoutProperties(){UI.data["column-width"]=316,UI.data.window=[],UI.data.window.width=$ui.window.width(),UI.data.window.height=$ui.window.height(),UI.data.columns=Math.floor(UI.data.window.width/UI.data["column-width"]);var e;e=1===UI.data.columns?"ui-single-column":2===UI.data.columns?"ui-dual-column":"ui-multi-column",$ui.body.removeClass("ui-single-column ui-dual-column ui-multi-column").addClass(e)}function setScrollPosition(){UI.data["scroll-position"].top=$ui.window.scrollTop(),UI.data["scroll-position"].bottom=UI.data["scroll-position"].top+UI.data.window.height}function upload(e){FileAPI.filterFiles(e,function(e,t){return/^image/.test(e.type)?(file_stack[e.name]=t,!0):!1},function(e,t){e.length&&($(".submit",$post).addClass("disabled"),FileAPI.each(e,function(e){var t=file_stack[e.name].exif.Orientation;if(file_stack[e.name].ref=tarefa_active+"-"+user.id+"-"+moment().format("X")+"-"+rand(0,999).toFixed(0),"image/gif"==e.type){var a=new FileReader;a.onload=function(t){var a=$("<img />").attr("src",t.target.result),o=$('<input type="hidden" name="image-order[]" />').val(file_stack[e.name].ref),i=$("<div />").addClass("progress");$("<div />").addClass("status").html("<strong>Enviando&hellip;</strong>").appendTo(i),$("<div />").addClass("bar").appendTo(i);var n=$("<li />").attr("id","file-"+file_stack[e.name].ref).append(o).append(i).append(a);$("#dropzone #board").append(n)},a.readAsDataURL(e)}else FileAPI.Image(e).rotate(exif_orientation_to_degrees[t]).resize(600,300,"preview").get(function(t,a){var o=$('<input type="hidden" name="image-order[]" />').val(file_stack[e.name].ref),i=$("<div />").addClass("progress");$("<div />").addClass("status").html("<strong>Enviando&hellip;</strong>").appendTo(i),$("<div />").addClass("bar").appendTo(i);var n=$("<li />").attr("id","file-"+file_stack[e.name].ref).append(o).append(i).append(a);$("#dropzone #board").append(n)})}),"image/gif"==e[0].type?(console.log("gif"),FileAPI.upload({url:"/-/lista/novo",data:{action:"upload",edition:Lista.Regulamento.edicao,tarefa:tarefa_active,turma:user.turma,user:user.id},prepare:function(e,t){t.data.ref=file_stack[e.name].ref,e.ref=file_stack[e.name].ref},files:e,fileprogress:function(e,t,a){var o=(e.loaded/e.total*100).toFixed(0),i=100>o?"<strong>Enviando&hellip;</strong> "+o+"%":"<strong>Processando&hellip;</strong>";$("#file-"+t.ref+" .status","#dropzone").html(i)},progress:function(e){},filecomplete:function(e,t,a){$("#file-"+a.ref+" .status","#dropzone").html('<i class="material-icons">check</i>')},complete:function(e,t){$(".submit",$post).removeClass("disabled")}})):FileAPI.upload({url:"/-/lista/novo",data:{action:"upload",edition:Lista.Regulamento.edicao,tarefa:tarefa_active,turma:user.turma,user:user.id},prepare:function(e,t){t.data.ref=file_stack[e.name].ref,e.ref=file_stack[e.name].ref},imageAutoOrientation:!0,imageTransform:{maxWidth:1920,maxHeight:1920},files:e,fileprogress:function(e,t,a){var o=(e.loaded/e.total*100).toFixed(0),i=100>o?"<strong>Enviando&hellip;</strong> "+o+"%":"<strong>Processando&hellip;</strong>";$("#file-"+t.ref+" .status","#dropzone").html(i)},progress:function(e){},filecomplete:function(e,t,a){$("#file-"+a.ref+" .status","#dropzone").html('<i class="material-icons">check</i>')},complete:function(e,t){$(".submit",$post).removeClass("disabled")}}))})}function checkUpdates(){var e=0;$.getJSON("https://api.laguinho.org/lista/"+edicao+"/atividade?key="+api_key+"&callback=?").done(function(t){if($.each(t,function(t,a){moment(a.ts).isAfter(last_updated)&&a.autor!=user.id&&(e++,"novo-post"==a.acao?updated.posts++:"nova-tarefa"==a.acao&&updated.tarefas++)}),e){var a,o=updated.tarefas+updated.posts;updated.tarefas>0&&updated.posts>0?a=updated.tarefas+(updated.tarefas>1?" novas tarefas":" nova tarefa")+" e "+updated.posts+(updated.posts>1?" novos posts":" novo post"):updated.tarefas>0?a=updated.tarefas+(updated.tarefas>1?" novas tarefas":" nova tarefa"):updated.posts>0&&(a=updated.posts+(updated.posts>1?" novos posts":" novo post")),$("head title").html("("+o+") "+page_title),UI.toast.open(a,"Atualizar",function(){Stream.load(),updated={tarefas:0,posts:0},$("head title").html(page_title)},!0,"stream-only")}last_updated=t[0]?moment(t[0].ts):moment()})}var edicao="xcii",Lista=[];Lista.Regulamento=[],Lista.Tarefas=[];var app=[],tarefas={};$(function(){});var timeout=[],$theme_color,theme_color={},tarefa_active,ui={},api_key;api_key="063c72b2afc5333f3b27b366bdac9eb81d64bc6a12cd7b3f4b6ade77a092b63a";var $templates={};$(function(){$("template").each(function(){var e=$(this),t=e.attr("id"),a=e.html();$templates[t]=$(a),e.remove()})});var router=[];router.path=location.pathname.split("/"),"tarefas"===router.path[1]?router["navigation-mode"]="path":(router["navigation-mode"]="hash",router.path=location.hash.split("/")),router.go=function(e,t,a){"path"===router["navigation-mode"]?history.pushState(t,a,e):history.pushState(t,a,"#"+e)},router["build-link"]=function(e){var t;return t="path"===router["navigation-mode"]?e:"#"+e},router["current-view"]=["home"],router["view-manager"]=function(){return{add:function(e){router["current-view"].push(e)},remove:function(e){router["current-view"]=$.grep(router["current-view"],function(t){return t!==e})},replace:function(e){router["current-view"]=[],router["view-manager"].add(e)}}}(),window.addEventListener("popstate",function(e){var t=e.state;t&&"tarefa"===t.view?(router["current-view"].indexOf("bottomsheet")>-1&&bottomsheet.close(),router["current-view"].indexOf("new-post")>-1&&post.close(),app.Tarefa.open(t.id)):t&&"new-post"===t.view?post.open(t.type,t.id):t&&"bottomsheet"===t.view?router["current-view"].indexOf("new-post")>-1&&post.close():(router["current-view"].indexOf("bottomsheet")>-1&&bottomsheet.close(),router["current-view"].indexOf("new-post")>-1&&post.close(),app.Tarefa.close())});var UI={},$ui=[];$ui.window=$(window),$.fn.reflow=function(){$ui.body.offset().left;return $(this)};var $window,$body;$(function(){$window=$ui.window,$body=$ui.body,$theme_color=$("meta[name='theme-color']"),theme_color.original=$theme_color.attr("content")}),UI.body=function(){return{lock:function(){$ui.body.addClass("no-scroll")},unlock:function(){$ui.body.removeClass("no-scroll")}}}(),$(function(){$ui.body=$(document.body)}),UI.data=[],UI.data["interaction-type"]="ontouchstart"in window||navigator.msMaxTouchPoints?"touch":"pointer",$(function(){$ui.body.addClass("ui-"+UI.data["interaction-type"])}),$(document).on("ready",setLayoutProperties),$ui.window.on("resize",setLayoutProperties),UI.data["scroll-position"]=[],$(document).on("ready",setScrollPosition),$ui.window.on("scroll",setScrollPosition),UI.backdrop=function(){return{show:function(e){var t=e.css("z-index")-1;$ui.backdrop.css("z-index",t).addClass("in")},hide:function(){$ui.backdrop.removeClass("in").css("z-index","").off("hide")}}}(),$(function(){$ui.backdrop=$(".js-ui-backdrop"),$ui.backdrop.on("click",function(){$ui.backdrop.trigger("hide")})}),UI.sidenav=function(){return{open:function(){UI.body.lock(),UI.backdrop.show($ui.sidenav),$ui.sidenav.addClass("in"),$ui.backdrop.on("hide",UI.sidenav.close)},close:function(){$ui.sidenav.removeClass("in"),UI.backdrop.hide(),UI.body.unlock()}}}(),$(function(){$ui.sidenav=$(".js-ui-sidenav"),$(".js-sidenav-trigger").on("click",function(e){e.preventDefault(),UI.sidenav.open()})}),UI.bottomsheet=function(){return{open:function(e,t){UI.backdrop.show($ui.bottomsheet),$ui.bottomsheet.html(e).addClass((t?t+" ":"")+"in").reflow().addClass("slide"),theme_color.buffer=$theme_color.attr("content"),$theme_color.attr("content","#000"),$ui.backdrop.on("hide",UI.bottomsheet.close),router["view-manager"].add("bottomsheet"),history.pushState({view:"bottomsheet"},null,null)},close:function(){$ui.bottomsheet.removeClass("slide").one("transitionend",function(){$ui.bottomsheet.removeClass("in").empty().attr("class","ui-bottomsheet js-ui-bottomsheet")}),$theme_color.attr("content",theme_color.buffer),UI.backdrop.hide(),router["view-manager"].remove("bottomsheet")}}}(),$(function(){$ui.bottomsheet=$(".js-ui-bottomsheet")}),UI.toast=function(){return{show:function(e){"object"==typeof e?($ui.toast.message.html(e.message),$ui.toast.action.html(e.action?e.action:""),$ui.toast.addClass("in").reflow().addClass("slide"),$ui.body.addClass("toast-active"),$ui.toast.on("click",UI.toast.dismiss),$ui.toast.action.on("click",e.callback),clearTimeout(timeout.toast),e.persistent?$ui.toast.addClass("stream-only"):($ui.toast.removeClass("stream-only"),timeout.toast=setTimeout(UI.toast.dismiss,e.timeout?e.timeout:6e3))):UI.toast.show({message:e})},dismiss:function(){$ui.toast.removeClass("slide").one("transitionend",function(){$ui.body.removeClass("toast-active"),$ui.toast.removeClass("in stream-only"),$ui.toast.message.empty(),$ui.toast.action.empty()}),clearTimeout(timeout.toast)},open:function(e,t,a,o){$ui.toast.message.html(e),$ui.toast.action.html(t?t:""),$ui.toast.addClass("in").reflow().addClass("slide"),$ui.body.addClass("toast-active"),$ui.toast.on("click",toast.close),$ui.toast.action.on("click",a),clearTimeout(timeout.toast),o?$ui.toast.addClass("stream-only"):($ui.toast.removeClass("stream-only"),timeout.toast=setTimeout(toast.close,6500))}}}();var toast=UI.toast;toast.close=UI.toast.dismiss,$ui.toast=[],$(function(){$ui.toast=$(".js-ui-toast"),$ui.toast.message=$(".toast-message",$ui.toast),$ui.toast.action=$(".toast-action",$ui.toast)}),app.Placar=function(e){var t=e.reduce(function(e,t){e+t.pontos,0});t=t?t:0,$placar.empty(),$.each(e,function(e,a){var o=t>0?a.pontos/t:0;a["altura-da-barra"]="height: "+(100*o).toFixed(3)+"%",a["turma-formatada"]=a.turma.toUpperCase(),a.pontos=a.pontos,a["pontuacao-formatada"]=a.pontos.toString().replace(/\B(?=(\d{3})+(?!\d))/g,".");var i=__render("placar-turma",a);$placar.append(i)}),0===t?$placar.parent().addClass("zeroed"):$placar.parent().removeClass("zeroed")};var $placar;$(function(){$placar=$(".js-placar ul")}),app.Lista=function(){return{load:function(){$stream.loading.addClass("fade-in in"),$.getJSON("https://api.laguinho.org/lista/"+edicao+"/tudo?key="+api_key+"&callback=?").done(function(e){Lista.Regulamento=e.meta,Lista.Tarefas=e.tarefas,e.meta.titulo&&(page_title=e.meta.titulo,$("head title").html(page_title)),e.meta.mensagem&&$(".js-mensagem-final").html(e.meta.mensagem),moment().isAfter(Lista.Regulamento.fim)&&$body.addClass("postagens-encerradas"),Lista.Regulamento.encerrada===!0&&($body.addClass("edicao-encerrada"),clearInterval(update_interval)),$stream.empty(),app.Placar(e.placar),$.each(e.tarefas,function(e,t){tarefas[t.numero]=t,t.url="/tarefas/"+t.numero,t.url=router["build-link"]("/tarefas/"+t.numero),t.imagem&&(t["imagem-url"]=t.imagem.url,t["imagem-aspecto"]="padding-top: "+(100*t.imagem.aspecto).toFixed(2)+"%");var a=__render("card-tarefa",t).data({tarefa:t.numero,"last-modified":t["ultima-postagem"]?moment(t["ultima-postagem"]).format("X"):0});t.preview&&(a.addClass("fantasma"),$("a",a).removeAttr("href"),$(".body",a).remove()),t.imagem||$(".media",a).remove();var o=$(".grid",a);if(t.posts&&t.posts.length)for(var i=t.posts.length,n=ui.columns<2?9:8,s=0,r=["imagem","youtube","vimeo","vine","gif"],l=["texto"],d=0;i>d;d++){var u=t.posts[d];if((u.midia||"texto"==u.tipo)&&n>s){s++;var m,c={};r.indexOf(u.tipo)>-1?(m="tile-image",c.count=s,"youtube"==u.tipo||"vimeo"==u.tipo||"vine"==u.tipo||"gif"==u.tipo?(c.preview="background-image: url('"+u.midia[0].thumbnail+"');",c.modifier="video"):u.midia&&u.midia[0]&&(c.preview="background-image: url('"+u.midia[0].caminho+u.midia[0].arquivos[0]+"');")):l.indexOf(u.tipo)>-1&&(m="tile-text",c={preview:u.legenda.substring(0,120),count:s}),s===n&&i-s>0&&(c.modifier="more",c.more="+&thinsp;"+(i-s+1));__render(m,c).appendTo(o)}}else o.remove();$stream.append(a).isotope("appended",a)}),app.Lista.layout(),app.Lista.sort(Lista.Regulamento.encerrada?"tarefa":"date"),router.path[2]&&app.Tarefa.open(router.path[2]),setTimeout(function(){$stream.loading.removeClass("fade-in").one("transitionend",function(){$stream.loading.removeClass("in")})},1200),last_updated=moment(e.meta["ultima-atualizacao"]),updated.tarefas=0,updated.posts=0})},layout:function(){$stream.isotope("reloadItems"),$stream.isotope("layout")},sort:function(e){$stream.isotope({sortBy:e})}}}();var $stream;$(function(){$stream=$("#stream"),$stream.loading=$("main .loading"),$stream.isotope({itemSelector:".card-tarefa",transitionDuration:".8s",getSortData:{date:".last-modified",tarefa:function(e){return parseInt($(e).data("tarefa"),10)}},sortAscending:{date:!1,tarefa:!0},sortBy:["date","tarefa"],masonry:{gutter:1===ui.columns?8:16}}),$stream.on("click",".card-tarefa:not(.fantasma)",function(e){if(1===e.which){e.preventDefault();var t=$(this).data("tarefa");app.Tarefa.open(t,!0)}}),app.Lista.load(),$ui.sidenav.on("click",".js-stream-sort a",function(e){e.preventDefault();var t=$(this).data("sort-by");$(".js-stream-sort a",$ui.sidenav).removeClass("active"),$(this).addClass("active"),app.Lista.sort(t),UI.sidenav.close()})}),app.Tarefa=function(){function e(e,a){t.total=0;for(var o in Lista.Regulamento.turmas)t[Lista.Regulamento.turmas[o]]=0;$.each(e,function(e,o){o["data-de-postagem-formatada"]=moment(o["data-de-postagem"]).calendar(),o["turma-formatada"]=o.turma.toUpperCase(),o.avaliacao?(200==o.avaliacao.status?(o["status-class"]=o.turma,o["status-icon"]='<i class="material-icons">&#xE87D;</i>',o.status=o.avaliacao.pontos+" ponto"+(o.avaliacao.pontos>1?"s":"")):(o["status-class"]="rejected",o["status-icon"]='<i class="material-icons">&#xE888;</i>',o.status="Reprovado"),o.mensagem=o.avaliacao.mensagem,t.total+=o.avaliacao.pontos,t[o.turma]+=o.avaliacao.pontos):(o["status-icon"]='<i class="material-icons">&#xE8B5;</i>',o.status="Aguardando avaliação"),o.legenda&&"<p>"!=o.legenda.substring(0,3)&&(o.legenda="<p>"+o.legenda.replace(/(?:\r\n\r\n|\r\r|\n\n)/g,"</p><p>")+"</p>");var i=__render("view-tarefa-post-card",o),n=$(".media",i);o.midia&&$.each(o.midia,function(e,t){if("imagem"==o.tipo){t["default"]=t.caminho+t.arquivos[1],t["padding-aspecto"]="padding-top: "+(100*t.aspecto).toFixed(2)+"%",t["link-original"]=t.caminho+t.arquivos[2];var a=__render("media-photo",t);n.append(a)}else if("youtube"==o.tipo||"vimeo"==o.tipo||"vine"==o.tipo){"youtube"==o.tipo?t.embed="https://www.youtube.com/embed/"+t["youtube-id"]+"?rel=0&amp;showinfo=0":"vimeo"==o.tipo?t.embed="https://player.vimeo.com/video/"+t["vimeo-id"]+"?title=0&byline=0&portrait=0":"vine"==o.tipo&&(t.embed="https://vine.co/v/"+t["vine-id"]+"/embed/simple"),t["padding-aspecto"]="padding-top: "+(100*t.aspecto).toFixed(2)+"%";var i=__render("media-video",t);n.append(i)}}),o.legenda||$(".caption",i).remove(),o.avaliacao&&o.mensagem||$(".result .message",i).remove(),a.append(i).isotope("appended",i)})}var t=[];return{open:function(e,t){var a=tarefas[e];tarefa_active=e,UI.data.columns>=3&&(UI.backdrop.show($tarefa),$ui.backdrop.on("hide",app.Tarefa.close)),$tarefa.addClass("in"),app.Tarefa.render(a),$tarefa.reflow().addClass("slide-x").one("transitionend",function(){$("head meta[name='theme-color']").attr("content","#546e7a")}),$ui.body.addClass("no-scroll tarefa-active"),router["view-manager"].replace("tarefa"),t&&router.go("/tarefas/"+a.numero,{view:"tarefa",id:a.numero},a.titulo)},render:function(a){var o=__render("view-tarefa",a),i=$(".painel .meta",o);a.imagem&&(tarefa["imagem-url"]=a.imagem.url,tarefa["imagem-aspecto"]="padding-top: "+(100*a.imagem.aspecto).toFixed(2)+"%");var n=__render("card-tarefa",a);a.imagem||$(".media",n).remove(),$(".grid",n).remove(),i.append(n);var s=o.find(".posts ul");a.posts.length?(s.isotope({itemSelector:".card",transitionDuration:0,masonry:{gutter:1===ui.columns?8:16}}),e(a.posts,s)):$("<li />").addClass("empty").text("Nenhum post").appendTo(s),$tarefa.html(o),a.posts.length&&s.isotope("layout");var r=$(".painel .placar ul",o);$.each(Lista.Regulamento.turmas,function(e,a){var o=[],i=t.total>0?t[a]/t.total:0;o.turma=a,o["altura-da-barra"]="height: "+(100*i).toFixed(3)+"%",o["turma-formatada"]=a.toUpperCase(),o.pontos=t[a]>0?t[a]:0,o["pontuacao-formatada"]=o.pontos.toString().replace(/\B(?=(\d{3})+(?!\d))/g,".");var n=__render("placar-turma",o);r.append(n)})},close:function(e){tarefa_active=null,$("head meta[name='theme-color']").attr("content",theme_color.original),$ui.body.removeClass("no-scroll tarefa-active"),$tarefa.removeClass("slide-x").one("transitionend",function(){$tarefa.removeClass("in").empty()}),UI.data.columns>=3&&UI.backdrop.hide(),router["view-manager"].replace("home"),e&&router.go("/tarefas",{view:"home"},"Lista de Tarefas")}}}();var $tarefa;$(function(){$tarefa=$("#tarefa"),$tarefa.on("click",".back",function(e){e.preventDefault(),app.Tarefa.close(!0)}).on("click",".js-new-post-trigger",function(){UI.bottomsheet.open($(".new-post-sheet",$tarefa).clone().show())}).on("click",".card-tarefa a",function(e){1===e.which&&e.preventDefault()})}),app.Post=function(){return{authorize:function(){$(".submit",$post).removeClass("disabled")},deauthorize:function(){$(".submit",$post).addClass("disabled")},getThumbnail:function(e){function t(e){var t=$("<img />").attr("src",e.thumbnail);$(".js-media-provider",$post).val(e.provider),$(".js-media-id",$post).val(e.id),$(".js-media-thumbnail",$post).val(e.thumbnail),$(".js-media-preview",$post).html(t).fadeIn()}var a={};if(e.match(/(?:https?:\/{2})?(?:w{3}\.)?youtu(?:be)?\.(?:com|be)(?:\/watch\?v=|\/)([^\s&]+)/)){var o=e.match(/(?:https?:\/{2})?(?:w{3}\.)?youtu(?:be)?\.(?:com|be)(?:\/watch\?v=|\/)([^\s&]+)/);a.provider="youtube",a.id=o[1],a.thumbnail="https://i1.ytimg.com/vi/"+o[1]+"/0.jpg",NewPost.authorize(),t(a)}else if(e.match(/vimeo\.com/)){var i=e.match(/\/\/(www\.)?vimeo.com\/(\d+)($|\/)/);a.provider="vimeo",a.id=i[2],$.getJSON("https://vimeo.com/api/v2/video/"+i[2]+".json?callback=?").done(function(e){a.thumbnail=e[0].thumbnail_large,NewPost.authorize(),t(a)})}else if(e.match(/vine\.co/)){var n=e.match(/\/\/(www\.)?vine\.co\/v\/([^\s&]+)($|\/)/);a.provider="vine",a.id=n[2],$.getJSON("//assets.laguinho.org/helpers/vine-thumbnail?id="+n[2]+"&callback=?").done(function(e){a.thumbnail=e.thumbnail,NewPost.authorize(),t(a)})}},open:function(e,t){var a={edicao:Lista.Regulamento.edicao,numero:t||tarefa_active,user:user.id,turma:user.turma,token:user.token},o=__render("new-post-"+e,a);$post.html(o).addClass("in").reflow().addClass("slide").one("transitionend",function(){var e=$(".appbar",$post).css("background-color");$("head meta[name='theme-color']").attr("content",e)}),NewPost.deauthorize(),"photo"===e?($post.dropzone(),$(".file-placeholder",$post).trigger("click")):"video"===e||"vine"===e?$(".js-media-url-input",$post).focus().on("keyup",function(){NewPost.getThumbnail($(this).val())}):"text"===e&&$(".js-caption-input",$post).focus().on("keyup",function(){$(this).val().length>0?NewPost.authorize():NewPost.deauthorize()}),router["view-manager"].replace("new-post"),history.replaceState({view:"new-post",type:e,id:a.numero},null,null)},close:function(){$("head meta[name='theme-color']").attr("content",theme_color.original),$post.removeClass("slide").one("transitionend",function(){$post.removeClass("in").empty()}),router["view-manager"].replace("tarefa")}}}();var post=NewPost,$post;$(function(){$post=$("#new-post"),$ui.bottomsheet.on("click",".new-post-sheet a",function(e){e.preventDefault();var t=$(this).data("post-type");bottomsheet.close(),setTimeout(function(){NewPost.open(t,tarefa_active)},600)}),$post.on("submit","form",function(e){e.preventDefault()}).on("click",".submit",function(e){if(e.preventDefault(),moment().isAfter(Lista.Regulamento.fim)&&toast.open("Postagens encerradas!"),$(this).hasClass("disabled"))return void toast.open("Espere o fim do upload&hellip;");var t=$("form",$post).serialize();$(".submit",$post).addClass("disabled").html("Enviando&hellip;"),$.post("/-/lista/novo",t).done(function(e){200===e.meta.status?(NewPost.close(),app.Tarefa.render(e.data),UI.toast.open(e.meta.message),navigator.vibrate(800),tarefas[e.data.numero]=e.data):UI.toast.open(e.meta.message?e.meta.message:"Ocorreu um erro. Tente novamente")}).fail(function(){toast.open("Ocorreu um erro. Tente novamente")})}).on("click",".back",function(e){e.preventDefault(),NewPost.close()})});var NewPost=app.Post,$login,login=function(){return{show:function(){$login.addClass("in").reflow().addClass("slide"),$body.addClass("no-scroll"),setTimeout(function(){$("input[name='email']",$login).focus()},300)},hide:function(){$body.removeClass("no-scroll"),$login.removeClass("slide").one("transitionend",function(){$login.removeClass("in")})}}}();$(function(){$login=$("#login"),$(".js-login-trigger",$ui.sidenav).on("click",function(e){e.preventDefault(),sidenav.close(),login.show()}),$login.on("click",".back",function(e){e.preventDefault(),login.hide()}).on("submit","form",function(e){e.preventDefault(),$.getJSON("https://api.laguinho.org/lista/"+edicao+"/auth?key="+api_key+"&callback=?",$("form",$login).serialize()).done(function(e){200===e.meta.status?(user=e.user,user["signed-in"]=!0,localStorage.setItem("user",JSON.stringify(user)),$body.addClass("signed-in user-"+user.turma),login.hide(),setTimeout(function(){UI.toast.show("Olá "+user.name+"!")},500)):($(".form-group",$login).addClass("animated shake"),setTimeout(function(){$(".form-group",$login).removeClass("animated shake")},1e3))})}),$(".js-logout-trigger",$ui.sidenav).on("click",function(e){e.preventDefault(),$body.removeClass("signed-in user-"+user.turma),user={id:null,name:null,email:null,token:null,turma:null,"signed-in":!1},localStorage.setItem("user",JSON.stringify(user)),sidenav.close(),setTimeout(function(){UI.toast.show("Sessão encerrada!")},500)})});var user={id:null,name:null,email:null,token:null,turma:null,"signed-in":!1};localStorage&&localStorage.getItem("user")&&(user=JSON.parse(localStorage.getItem("user")),$(function(){null!==user.id&&($ui.body.addClass("signed-in user-"+user.turma),setTimeout(function(){UI.toast.show("Olá "+user.name+"!")},3e3))}));var exif_orientation_to_degrees={0:0,1:0,2:0,3:180,4:0,5:0,6:90,7:0,8:270},file_stack={};$.fn.dropzone=function(){var e=$("#dropzone",this);FileAPI.event.dnd(e[0],function(t){t?e.addClass("active"):e.removeClass("active")},function(e){upload(e)});var t=document.getElementById("form-file");FileAPI.event.on(t,"change",function(e){var t=FileAPI.getFiles(e);upload(t)});var a=$("#board",this);a.on("slip:beforewait",function(e){"pointer"===ui["interaction-type"]&&e.preventDefault()}).on("slip:afterswipe",function(e){e.target.remove()}).on("slip:reorder",function(e){return e=e.originalEvent,e.target.parentNode.insertBefore(e.target,e.detail.insertBefore),!1}),new Slip(a[0])};var update_interval=setInterval(checkUpdates,3e4),page_title=$("head title").html(),last_updated,updated={tarefas:0,posts:0};WebFont.load({timeout:1e4,google:{families:["Material Icons","Roboto:400,400italic,500:latin","Montserrat::latin"]},custom:{families:["FontAwesome"],urls:["https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.3.0/css/font-awesome.min.css"]},active:function(){$(function(){app.Lista.layout()})}}),moment.locale("pt-br",{months:"janeiro_fevereiro_março_abril_maio_junho_julho_agosto_setembro_outubro_novembro_dezembro".split("_"),monthsShort:"jan_fev_mar_abr_mai_jun_jul_ago_set_out_nov_dez".split("_"),weekdays:"domingo_segunda-feira_terça-feira_quarta-feira_quinta-feira_sexta-feira_sábado".split("_"),weekdaysShort:"dom_seg_ter_qua_qui_sex_sáb".split("_"),weekdaysMin:"dom_2ª_3ª_4ª_5ª_6ª_sáb".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D [de] MMMM [de] YYYY",LLL:"D [de] MMMM [de] YYYY [às] HH:mm",LLLL:"dddd, D [de] MMMM [de] YYYY [às] HH:mm"},calendar:{sameDay:"[hoje às] LT",nextDay:"[amanhã às] LT",nextWeek:"dddd [às] LT",lastDay:"[ontem às] LT",lastWeek:"dddd [às] LT",sameElse:"L"},relativeTime:{future:"daqui %s",past:"%s atrás",s:"poucos segundos",m:"um minuto",mm:"%d minutos",h:"uma hora",hh:"%d horas",d:"um dia",dd:"%d dias",M:"um mês",MM:"%d meses",y:"um ano",yy:"%d anos"},ordinalParse:/\d{1,2}º/,ordinal:"%dº"});